import Foundation

class Validator {
    static let regexRepository = [
      "email": "[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,64}",
      "username": "^[a-z0-9]{1,64}$",
      "password": "^.{8,32}$"
    ]
    
    class func testRegexMatch(regexFor: String, text: String) -> Bool {
        do {
            let regex = try RegularExpression(pattern: regexRepository[regexFor]!, options: [])
            let nsString = NSString(string: text)
            let results = regex.matches(in: text, options: [], range: NSRange(location: 0, length: nsString.length))
            return results.count > 0
        }
        catch {
            return false
        }
    }
}
